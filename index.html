<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CELPIP Daily Vocab (400)</title>

  <link rel="stylesheet" href="./assets/css/styles.css" />

  <!-- Supabase client (email/password auth + sync). Provides window.supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
<div class="wrap">
  <header>
    <div class="topbar">
      <div class="brandArea">
        <h1>CELPIP Daily Vocab</h1>
      </div>
    
      <div class="authArea">
        <div class="pillrow" id="authBox">
          <!-- Signed OUT -->
          <div class="authSignedOut" id="authSignedOut">
            <div class="pill">
              <span class="muted">Email</span>
              <input id="emailInput" type="email" placeholder="you@email.com" />
            </div>
      
            <div class="pill">
              <span class="muted">Password</span>
              <input id="passwordInput" type="password" placeholder="••••••••" />
            </div>
      
            <button class="mini primary" id="signInBtn">Sign in</button>
            <button class="mini" id="signUpBtn">Sign up</button>
          </div>
      
          <!-- Signed IN -->
          <div class="authSignedIn" id="authSignedIn" style="display:none;">
            <div class="pill" id="userPill">
              <span class="muted">Hi,</span>
              <span id="userName" class="username">—</span>
            </div>
          
            <!-- Desktop logout button -->
            <button class="mini" id="logoutBtn">Log out</button>
          
            <!-- Mobile hamburger -->
            <div class="menuWrap" id="authMenuWrap">
              <button class="mini" id="authMenuBtn" type="button" aria-label="Account menu" aria-expanded="false">☰</button>
              <div class="menu" id="authMenu" role="menu" aria-label="Account">
                <button class="mini" id="logoutBtnMobile" type="button" role="menuitem">Log out</button>
              </div>
            </div>
          </div>
      
          <div class="footer" id="authStatus"></div>
        </div>
      </div>

    </div>
  </header>
  
  <div class="pillrow">
    <div class="pill" title="How many new words to learn each day">
      <span class="muted">Words/day</span>
      <input id="perDay" type="number" min="5" max="50" step="1" value="10" />
    </div>
    <div class="pill" title="Choose what the main card pulls from">
      <span class="muted">Deck</span>
      <select id="deckMode">
        <option value="today">Today</option>
        <option value="hard">Hard</option>
        <option value="all">All</option>
      </select>
    </div>
    <button class="mini bad" id="resetBtn" title="Clears Known/Hard marks (local + cloud)">Reset Progress</button>
  </div>

  <div class="tabs">
    <div class="tab active" data-tab="learn">Learn (Flashcards)</div>
    <div class="tab" data-tab="quiz">Quick Quiz</div>
    <div class="tab" data-tab="browse">Browse & Search</div>
    <div class="tab" data-tab="stats">Stats</div>
  </div>

  <div class="grid">
    <section class="card bigcard" id="mainPanel">
      <h2 id="panelTitle">Learn</h2>

      <!-- Flashcard -->
      <div id="flashPanel">
        <div class="flash" id="flashCard" role="button" tabindex="0" aria-label="Flashcard (tap to flip)">
          <div class="word" id="flashWord">—</div>
          <div class="def" id="flashDef" style="display:none;">—</div>
          <div class="hint" id="flashHint">
            <span class="hint-mobile">Tap to reveal definition</span>
            <span class="hint-desktop">
              Tap to reveal definition • <span class="kbd">Space</span> flip •
              <span class="kbd">←</span>/<span class="kbd">→</span> prev/next •
              <span class="kbd">K</span> known • <span class="kbd">H</span> hard
            </span>
          </div>
        </div>
        <div class="row">
          <button class="mini primary" id="prevBtn">← Prev</button>
          <button class="mini primary" id="nextBtn">Next →</button>
          <button class="mini good" id="knownBtn">Known ✓</button>
          <button class="mini warn" id="hardBtn">Hard ★</button>
        </div>
        <div class="bar" aria-label="Progress bar"><div id="progressBar"></div></div>
        <div class="footer" id="progressText"></div>
      </div>

      <!-- Quiz -->
      <div id="quizPanel" style="display:none;">
        <div class="quizbox">
          <div class="muted">Type the <b>meaning</b> (or a close synonym). Then check.</div>
          <div class="flash" id="quizCard" style="cursor:default;">
            <div class="word" id="quizWord">—</div>
            <div class="def" id="quizAnswer" style="display:none;">—</div>
            <div class="hint">Tip: you don’t need perfect wording — just be close.</div>
          </div>
          <input id="quizInput" placeholder="Meaning / synonym..." />
          <div class="row">
            <button class="mini primary" id="checkBtn">Check</button>
            <button class="mini primary" id="revealBtn">Reveal</button>
            <button class="mini good" id="quizKnownBtn">Mark Known ✓</button>
            <button class="mini warn" id="quizHardBtn">Mark Hard ★</button>
            <button class="mini" id="newQuizBtn">New Word</button>
          </div>
          <div class="footer" id="quizFeedback"></div>
        </div>
      </div>

      <!-- Browse -->
      <div id="browsePanel" style="display:none;">
        <input id="searchInput" class="search" placeholder="Search word or meaning…" />
        <div class="footer">Tap a result to load it into the main card.</div>
        <div class="list" id="searchList"></div>
      </div>

      <!-- Stats -->
      <div id="statsPanel" style="display:none;">
        <div class="item">
          <div class="itemtop">
            <div>
              <div class="itemw">Your Progress</div>
              <div class="itemd">Known = mastered (for now). Hard = needs extra review.</div>
            </div>
          </div>
          <div class="row" style="margin-top:6px;">
            <div class="pill"><span class="muted">Total</span> <span id="stTotal">—</span></div>
            <div class="pill"><span class="muted">Known</span> <span id="stKnown">—</span></div>
            <div class="pill"><span class="muted">Hard</span> <span id="stHard">—</span></div>
            <div class="pill"><span class="muted">Unseen</span> <span id="stUnseen">—</span></div>
          </div>
          <div class="footer" style="margin-top:8px;">
            Pro tip: keep Words/day at 10–20 and revisit “Hard” until it shrinks.
          </div>
        </div>

        <div class="item">
          <div class="itemw">Backup / Transfer (optional)</div>
          <div class="itemd">Export/import progress manually (useful as a backup even with sync).</div>
          <div class="row" style="margin-top:8px;">
            <button class="mini primary" id="exportBtn">Export JSON</button>
            <button class="mini primary" id="importBtn">Import JSON</button>
          </div>
          <input id="importFile" type="file" accept="application/json" style="display:none;" />
          <div class="footer" id="backupNote"></div>
        </div>
      </div>
    </section>

    <aside class="card">
      <h2>Today’s List</h2>
      <div class="footer" id="todayMeta"></div>
      <div class="list" id="todayList"></div>
      <div class="footer" style="margin-top:10px;">
        Tip: switch Deck → <b>Hard</b> to focus on tough words.
      </div>
    </aside>
  </div>

  <div class="footer">
    Progress isn’t saved in Guest mode. Sign in to save and sync your progress to your account.
  </div>
</div>

<div class="toast" id="toast">Saved</div>

<script type="module" src="./assets/js/app.js"></script>
</body>
</html>
